#!/usr/bin/env node

/**
 * Super Prompt CLI - Node.js wrapper
 * Delegates to Python core implementation
 */

const { execa } = require('execa');
const path = require('path');

async function main() {
  try {
    // Correctly locate the Python launcher relative to the project root
    const projectRoot = path.resolve(__dirname, '..', '..', '..');
    const launcherPath = path.join(projectRoot, '.super-prompt', 'cli.py');

    // Check if the launcher exists
    const fs = require('fs');
    if (!fs.existsSync(launcherPath)) {
      console.error('❌ Super Prompt launcher not found. Please run initialization.');
      process.exit(1);
    }

    // Execute Python launcher with all arguments
    await execa('python3', [launcherPath, ...process.argv.slice(2)], {
      cwd: process.cwd(),
      stdio: 'inherit'
    });

  } catch (error) {
    // Suppress exit code errors from the child process
    if (error.exitCode !== 0 && error.exitCode != null) {
        return;
    }
    console.error('❌ Failed to execute Super Prompt:', error.message);
    process.exit(1);
  }
}

if (require.main === module) {
  main();
}
